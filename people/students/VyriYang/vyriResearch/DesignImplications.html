<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <!-- ä½¿ç”¨é¦–é æ¨£å¼ï¼ˆä¿ç•™ä½ çš„æ¨£å¼èˆ‡è·¯å¾‘ï¼‰ -->
  <link rel="stylesheet" href="../scrollspy.min.v.css"/>
  <link rel="stylesheet" href="../style.v.css"/>
  <title>Design Implications</title>
  <style>
  .main-content {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    background-image: 
      linear-gradient(rgba(4, 55, 83, 0.7), rgba(4, 83, 40, 0.7)), 
      url('');
    background-size: cover;
    background-position: top;
    animation: moveBg 280s infinite alternate;
    color: white;
    min-height: 60vh;
    box-sizing: border-box;
  }

  @keyframes moveBg {
    0% { background-position: top; }
    50% { background-position: bottom; }
    100% { background-position: top; }
  }

  /* çˆ¶å®¹å™¨æ ·å¼ï¼Œå±…ä¸­æ˜¾ç¤ºå›¾ç‰‡ */
  .img-container {
    display: flex;
    flex-direction: column; /* æ”¹æˆç¸±å‘æ’åˆ— */
    align-items: center;
    justify-content: center;
    gap: 20px;
    margin-top: 80px;
  }

  /* ä¸»åœ–æ¨£å¼ */
  .research-image {
    width: 100%;
    max-width: 1080px;
    height: auto;
    cursor: pointer;
    justify-content: center;
    align-items: center;
    transition: transform 0.3s ease;
  }
  .research-image:hover {
    transform: scale(1.1);
  }

  /* æ‚¬æµ®æ¡†æ ·å¼ */
  .modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0; top: 0;
    width: 100%; height: 100%;
    overflow: auto;
    background-color: rgba(37, 37, 37, 0.6);
  }

  /* åŸå›¾æ˜¾ç¤ºåœ¨æ‚¬æµ®æ¡†ä¸­ï¼Œä¸Šä¸‹å·¦å³å±…ä¸­ */
  .modal-content {
    margin: auto;
    position: absolute;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    display: block;
    width: 80%;
    max-width: 1080px;
  }

  /* å…³é—­æŒ‰é’®æ ·å¼ */
  .close {
    position: absolute;
    top: 15px; right: 35px;
    color: white; font-size: 40px; font-weight: bold;
    transition: 0.3s; cursor: pointer;
  }
  .close:hover, .close:focus { color: #bbb; text-decoration: none; cursor: pointer; }

  /* å·¦å³ç®­å¤´æ ·å¼ */
  .img_arrow {
    cursor: pointer;
    position: absolute;
    top: 50%;
    width: auto; padding: 16px; margin-top: -22px;
    color: white; font-weight: bold; font-size: 18px;
    transition: 0.6s ease; user-select: none;
  }
  .prev { left: 0; }
  .next { right: 0; }
  .img_arrow:hover { background-color: rgba(0,0,0,0.8); }

  /* è¼”åŠ©åœ–å®¹å™¨ */
  .img-more-container {
    display: flex;
    flex-direction: column; /* æ”¹æˆç¸±å‘æ’åˆ— */
    align-items: center;
    gap: 20px;
    margin-top: 40px;
    width: 100%;
  }

  /* è¼”åŠ©åœ–æ¨£å¼ */
  .img-more-container img {
    width: 100%;
    max-width: 1080px;
    height: auto;
    cursor: pointer;
    transition: transform 0.3s ease;
  }
  .img-more-container img:hover {
    transform: scale(1.1);
  }

  .centered-img { display: block; margin: 0 auto; }
  .cursor:hover { cursor: pointer; }
</style>

</head>
<body>
  <!-- é¦–é é¢¨æ ¼å°è¦½åˆ— -->
  <nav id="sticky-navbar" class="research-navbar">
    <ul class="nav-links">
      <li><a href="../VyriYang.html">VYRI YANG</a></li>
      <li><a href="../VyriYang.html#Projects">Projects</a></li>
      <li><a href="../VyriYang.html#Publications" id="publications-link">Publications</a></li>
      <!--li><a href="../VyriYang.html#Videos" id="videos-link">Videos</a></li-->
      <li><a href="../VyriYang.html#Awards" id="awards-link">Awards</a></li>
      <li>
        <a href="https://vyriyang.wixsite.com/vyri-yang/fashion" id="design" target="_blank" rel="noopener noreferrer">
          Design
        </a>
      </li>
      <li><a href="../VyriYang.html#Contact" id="contact-link">Contact</a></li>
      <li><a href="../VYRI YANG Resume.pdf" target="_blank">Resume</a></li>
      <!-- <li><a href="https://chive.cse.lsu.edu">CHIVE Home</a></li> -->
    </ul>
  </nav>

  <section class="content-section"></section>

  <!-- Topï¼šåŸºæœ¬è³‡è¨Š -->
  <section class="content-section" id="Top">
    <div class="section-inner">
      <div class="about">
        <div class="sec_sub_title_s" id="researchTitle"></div>
        <div class="project-title-text-data" id="researchName"></div>
        <div class="sec_sub_title_s" id="researchContent"></div>
        <div id="researchers-info" style="margin-top: 10px; margin-bottom: 20px;"></div>
        <div class="keywords-container"></div>
        <div class="download-container"></div>
      </div>
    </div>
  </section>

  <!-- Latest News -->
  <!--section class="content-section">
    <div class="section-inner">
      <div class="section-title-text-data">Latest News</div>
      <div class="about">
        <div class="sec_sub_title_s">
          â— Our paper, 'Animating the Narrative: A Review of Animation Styles in Narrative Visualization,' has been accepted for presentation at
          <a href="https://ieeevis.org/year/2024/welcome" style="text-decoration: none; color:#357132;" rel="alternate bookmark" target="_blank">IEEE VIS2024</a>.
          Join us in Tampa, Florida, on October 17th, 2024!<br>
        </div>
      </div>
    </div>
  </section-->

  <!-- Abstractï¼ˆä¿ç•™ä¸»åœ–ï¼‰ -->
  <section class="content-section" id="Abstract">
    <div class="section-inner">
      <div class="section-title-text-data">Abstract</div>
      <div class="about">
        <div class="abstract-container">
          <div id="researchAbstract"></div>
          <!-- ä¸»åœ– -->
          <div class="img-container">
            <img src="" id="mainImage" class="research-image centered-img" alt="Main Image"/>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Introductionï¼ˆå‹•æ…‹æ¸²æŸ“/éš±è—ï¼‰ -->
  <section class="content-section" id="Introduction">
    <div class="section-inner">
      <div class="section-title-text-data">Introduction</div>
      <div class="about">
        <div class="abstract-container">
          <div id="researchIntro"></div>
        </div>
      </div>
    </div>
  </section>

  <!-- Methodologyï¼ˆå‹•æ…‹æ¸²æŸ“/éš±è—ï¼‰ -->
  <section class="content-section" id="Methodology">
    <div class="section-inner">
      <div class="section-title-text-data">Methodology</div>
      <div class="about">
        <div class="abstract-container">
          <div id="researchMethod"></div>
        </div>
      </div>
    </div>
  </section>

  <!-- è¼”åŠ©åœ–ï¼ˆç§»åˆ°æ–° sectionï¼›ç„¡æ¨™é¡Œï¼‰ -->
  <section class="content-section" id="MoreImages">
    <div class="section-inner">
      <div class="about">
        <div class="img-container" style="margin-top:20px;">
          <div id="imgMoreContainer"></div>
        </div>
      </div>
    </div>
  </section>

  <!-- Discussionï¼ˆå‹•æ…‹æ¸²æŸ“/éš±è—ï¼›ä¾†æº research.resultï¼‰ -->
  <section class="content-section" id="Discussion">
    <div class="section-inner">
      <div class="section-title-text-data">Discussion</div>
      <div class="about">
        <div class="abstract-container">
          <div id="researchResult"></div>
        </div>
      </div>
    </div>
  </section>

  <!-- æ‡¸æµ®æ¡† -->
  <div id="myModal" class="modal">
    <span class="close">&times;</span>
    <span class="prev img_arrow">&#10094;</span>
    <img class="modal-content" id="modalImage" alt="modal image">
    <span class="next img_arrow">&#10095;</span>
  </div>

  <!-- Publications -->
  <section class="content-section" id="Publications">
    <div class="section-inner">
      <div class="section-title-text-data">Publications</div>
      <div class="mn-acc-app">
        <div class="mn-accordion" id="accordion-2"></div>
      </div>
    </div>
  </section>

  <!-- Videos -->
  <section class="video-section" id="Videos">
    <div class="section-inner">
      <div class="section-title-text-data">Videos</div>
      <div id="info-content"></div>
    </div>
  </section>

  <!-- Contact -->
  <section class="contact-section" id="Contact">
    <div class="section-inner">
      <div class="section-title-text-data">Contact</div>
      <div class="about">
        <div id="contact-details"></div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <div class="footer_v">
    <div class="cont_footer_v">Â© 2025 All rights reserved</div>
  </div>

  <!-- ä¿ç•™ä½ çš„è…³æœ¬è·¯å¾‘ -->
  <script src="../mn-accordion.v.js"></script>
  <script src="../scrollspy.min.v.js"></script>

  <script>
  document.addEventListener("DOMContentLoaded", function () {
    // ===== å·¥å…· =====
    const byId = (id) => document.getElementById(id);
    const safeArray = (x) => Array.isArray(x) ? x : [];
    const isHttp = location.protocol === "http:" || location.protocol === "https:";
    if (!isHttp) console.warn("[Hint] å»ºè­°ç”¨æœ¬æ©Ÿä¼ºæœå™¨ï¼ˆhttp://ï¼‰é–‹å•Ÿæ­¤é ï¼Œé¿å…ç€è¦½å™¨åœ¨ file:// å°é– fetchã€‚");

    // ===== Modalï¼ˆä¿ç•™ä½ çš„è¡Œç‚ºï¼‰ =====
    const modal = byId("myModal");
    const modalImg = byId("modalImage");
    const closeBtn = document.getElementsByClassName("close")[0];
    const prevArrow = document.querySelector(".prev");
    const nextArrow = document.querySelector(".next");
    let zoomedIn = false;
    let currentImgIndex = 0;
    let imgMoreList = [];

    // ===== Projectsï¼šè®€å…¥å–®ç­† DesignImplications =====
    fetch("../json/VyriYang-project.json", { cache: "no-store" })
      .then((res) => {
        if (!res.ok) throw new Error("Failed to load ../json/VyriYang-project.json: " + res.status);
        return res.json();
      })
      .then((data) => {
        const list = Array.isArray(data?.projects) ? data.projects : (Array.isArray(data) ? data : []);
        if (!list.length) { console.warn("[Projects] JSON ç‚ºç©ºæˆ–çµæ§‹ä¸ç¬¦ã€‚"); return; }

        const research = list.find((item) => safeArray(item?.label).includes("DesignImplications"));
        if (!research) { console.warn('[Projects] æ‰¾ä¸åˆ° label å« "DesignImplications" çš„å°ˆæ¡ˆã€‚'); return; }

        // ===== ä¸»åœ–èˆ‡æ›´å¤šåœ–ç‰‡ =====
        const mainImage = byId("mainImage");
        const imgMoreContainer = byId("imgMoreContainer");

        // ğŸ‘‰ é©é…è’™ç‰ˆåœ–ç‰‡å°ºå¯¸ï¼ˆä¸è¶…éè¦–çª—å¯¬é«˜ï¼‰
        function fitModalImg() {
          const padding = 32;
          const vw = Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0);
          const vh = Math.max(document.documentElement.clientHeight || 0, window.innerHeight || 0);
          modalImg.style.width = "auto";
          modalImg.style.height = "auto";
          modalImg.style.maxWidth = (vw - padding) + "px";
          modalImg.style.maxHeight = (vh - padding) + "px";
          modalImg.style.objectFit = "contain";
        }
        modalImg.addEventListener("load", fitModalImg);
        window.addEventListener("resize", fitModalImg);

        if (research.imgSrc) {
          mainImage.src = research.imgSrc;
          mainImage.classList.add("centered-img");
          mainImage.onclick = function () {
            modal.style.display = "block";
            modalImg.src = this.src;
            currentImgIndex = 0;
            modalImg.classList.remove("zoom-in", "zoom-out");
            fitModalImg();
          };
        }

        // æ”¶é›†æ‰€æœ‰åœ–ç‰‡ï¼ˆä¸»åœ– + æ›´å¤šåœ–ç‰‡ï¼‰
        const more = safeArray(research.imgMore).filter(Boolean);
        imgMoreList = research.imgSrc ? [research.imgSrc, ...more] : [...more];

        // è‹¥æ²’æœ‰è¼”åŠ©åœ–ï¼Œéš±è— MoreImages å€å¡Š
        const moreImagesSection = byId("MoreImages");
        if (imgMoreList.length <= 1) {
          if (moreImagesSection) moreImagesSection.style.display = "none";
        } else {
          // å»ºç«‹è¼”åŠ©åœ–ç¸®åœ–
          imgMoreContainer.classList.add("img-more-container");
          imgMoreList.slice(1).forEach((src, idx) => {
            const img = document.createElement("img");
            img.src = src;
            img.onclick = function () {
              modal.style.display = "block";
              modalImg.src = src;
              currentImgIndex = idx + 1;
              modalImg.classList.remove("zoom-in", "zoom-out");
              fitModalImg();
            };
            imgMoreContainer.appendChild(img);
          });
        }

        // ç®­é ­åˆ‡æ›
        function updateArrowState() {
          if (imgMoreList.length <= 1) {
            prevArrow.style.display = "none";
            nextArrow.style.display = "none";
          } else {
            prevArrow.style.display = "block";
            nextArrow.style.display = "block";
          }
        }
        updateArrowState();

        prevArrow.onclick = function () {
          if (imgMoreList.length > 1) {
            currentImgIndex = currentImgIndex > 0 ? currentImgIndex - 1 : imgMoreList.length - 1;
            modalImg.src = imgMoreList[currentImgIndex];
          }
        };
        nextArrow.onclick = function () {
          if (imgMoreList.length > 1) {
            currentImgIndex = currentImgIndex < imgMoreList.length - 1 ? currentImgIndex + 1 : 0;
            modalImg.src = imgMoreList[currentImgIndex];
          }
        };

        // ğŸ”¹ ç¢ºä¿ X æŒ‰éˆ•æ°¸é å¯ç”¨
        closeBtn.onclick = function () {
          modal.style.display = "none";
          zoomedIn = false;
          modalImg.classList.remove("zoom-in", "zoom-out");
        };

        // ===== æ¨™é¡Œ/å…§å®¹ =====
        byId("researchTitle").textContent = research.info ?? "";
        byId("researchName").textContent = research.title ?? "";
        byId("researchContent").textContent = research.content ?? "";

        // ===== Researchersï¼šhover/é»æ“Šè¦å‰‡ï¼ˆVyri åŒé é–‹å•Ÿ; ç„¡ link ç°è‰²ï¼‰ =====
        const researchers = safeArray(research.researchers);
        if (researchers.length) {
          const researchersInfo = researchers
            .map((r) => {
              const name = r?.name ?? "";
              let link = r?.link ?? "";
              if (link && !/^https?:\/\//i.test(link)) {
                link = `https://chive.cse.lsu.edu/${link.replace(/^\/+/, "")}`;
              }
              return `<span class="cont-researcher-name" data-name="${name}" data-link="${link}" style="cursor:pointer;">${name}</span>`;
            })
            .join(", ");

          byId("researchers-info").innerHTML =
            `<span class="cont-researcher-name_" style="cursor:default;">Researchers:</span> ${researchersInfo}`;

          document.querySelectorAll(".cont-researcher-name").forEach((el) => {
            el.addEventListener("mouseover", function () {
              const link = this.getAttribute("data-link") || "";
              if (!link.trim()) { this.style.color = "#5d5d5d"; this.style.cursor = "default"; }
              else { this.style.color = "#EBBA4D"; this.style.cursor = "pointer"; }
            });
            el.addEventListener("mouseout", function () {
              const link = this.getAttribute("data-link") || "";
              if (!link.trim()) { this.style.color = "#5d5d5d"; this.style.cursor = "default"; }
              else { this.style.color = ""; this.style.cursor = ""; }
            });
            el.addEventListener("click", function () {
              const link = this.getAttribute("data-link");
              const name = this.getAttribute("data-name") || "";
              if (!link || !link.trim()) return;
              if (name.trim() === "Vyri Yang") window.location.href = link;
              else window.open(link, "_blank", "noopener");
            });
          });
        }

        // ===== é—œéµè©ï¼ˆæ©«å‘æ’åˆ—ï¼‰ =====
        const keywordsContainer = document.querySelector(".keywords-container");
        if (keywordsContainer) {
          keywordsContainer.innerHTML = "";
          keywordsContainer.style.display = "flex";
          keywordsContainer.style.flexWrap = "wrap";
          keywordsContainer.style.gap = "10px";
          safeArray(research.keywords).slice(0, 5).forEach((kw) => {
            const div = document.createElement("div");
            div.className = "sec_sub_title_s";
            div.style.whiteSpace = "nowrap";
            div.textContent = `#${kw}`;
            keywordsContainer.appendChild(div);
          });
        }

        // ===== View Full Paper =====
        const downloadContainer = document.querySelector(".download-container");
        if (research.pdf) {
          const btn = document.createElement("a");
          btn.className = "sec_sub_title_sp";
          btn.href = research.pdf;
          btn.target = "_blank";
          btn.textContent = "View Full Paper";
          btn.style.textDecoration = "none";
          downloadContainer.appendChild(btn);
        }

        // ===== Abstract æ–‡å­— =====
        if (research.abstract) {
          byId("researchAbstract").innerHTML =
            `<span class="sec_sub_title_s">${String(research.abstract).replace(/\n/g, "<br>")}</span>`;
        }

        // ===== Introductionï¼ˆè‹¥ç„¡ â†’ éš±è—æ•´å€‹ sectionï¼‰=====
        const introSec = byId("Introduction");
        const introHolder = byId("researchIntro");
        if (research.intro && String(research.intro).trim()) {
          introHolder.innerHTML = `<span class="sec_sub_title_s">${String(research.intro).replace(/\n/g, "<br>")}</span>`;
        } else {
          introSec.style.display = "none";
        }

        // ===== Methodologyï¼ˆè‹¥ç„¡ â†’ éš±è—æ•´å€‹ sectionï¼‰=====
        const methodSec = byId("Methodology");
        const methodHolder = byId("researchMethod");
        if (research.method && String(research.method).trim()) {
          methodHolder.innerHTML = `<span class="sec_sub_title_s">${String(research.method).replace(/\n/g, "<br>")}</span>`;
        } else {
          methodSec.style.display = "none";
        }

        // ===== Discussionï¼ˆä¾†æº research.resultï¼›è‹¥ç„¡ â†’ éš±è—æ•´å€‹ sectionï¼‰=====
        const discussSec = byId("Discussion");
        const resultHolder = byId("researchResult");
        if (research.result && String(research.result).trim()) {
          resultHolder.innerHTML = `<span class="sec_sub_title_s">${String(research.result).replace(/\n/g, "<br>")}</span>`;
        } else {
          discussSec.style.display = "none";
        }

        // ===== Contact =====
        const contactDetails = byId("contact-details");
        const contactSection = byId("Contact");
        const office = research.office ?? "";
        const school = research.school ?? "";
        const num = research.num ?? "";
        const email = research.email ?? "";
        let contactHTML = "";

        if (researchers.length) {
          const first = researchers[0];
          const name = first?.name ?? "";
          let link = first?.link ?? "";
          if (link && !/^https?:\/\//i.test(link)) {
            link = `https://chive.cse.lsu.edu/${link.replace(/^\/+/, "")}`;
          }
          if (name) {
            contactHTML += `
              <div class="sec_sub_title_s">
                <a href="${link || "#"}" target="_blank" style="cursor:pointer; text-decoration: none;">
                  ${name}
                </a>
              </div>`;
          }
        }
        if (office) contactHTML += `<div class="sec_sub_title_s">${office}</div>`;
        if (school) contactHTML += `<div class="sec_sub_title_s">${school}</div>`;
        if (num) contactHTML += `<div class="sec_sub_title_s">${num}</div>`;
        if (email) {
          contactHTML += `
            <div class="sec_sub_title_s">
              <a href="mailto:${email}" style="color: #3f44b6;">${email}</a>
            </div>`;
        }

        if (contactHTML.trim()) {
          contactDetails.innerHTML = contactHTML;
        } else {
          contactSection.style.display = "none";
        }

        // Contact å€å¡Š hover è‰²
        const style = document.createElement("style");
        style.innerHTML = `
          #contact-details a { color: #5f5d5d; }
          #contact-details a:hover { color: #357132; }
        `;
        document.head.appendChild(style);

        // ===== Videosï¼ˆä¿ç•™ä½ åŸæœ¬çš„è™•ç†ï¼›è‡ªå‹•æŠ“ url-2/3/...ï¼‰=====
        {
          const infoContent = document.getElementById('info-content');
          const videoSection = document.getElementById('Videos');
          if (!infoContent || !videoSection) return;

          const src = Array.isArray(data?.projects) ? data.projects
                    : Array.isArray(data) ? data
                    : [];

          const candidates = src.filter(infoItem =>
            Array.isArray(infoItem?.label) &&
            infoItem.label.includes("DesignImplications") &&
            (infoItem.url || infoItem.videoSrc)
          );

          if (!candidates.length) {
            videoSection.style.display = 'none';
          } else {
            videoSection.style.display = '';

            function toEmbedUrl(u) {
              if (!u) return '';
              if (u.includes('youtube.com') || u.includes('youtu.be')) {
                let videoId = '';
                let start = '';

                if (u.includes('youtu.be/')) {
                  videoId = u.split('youtu.be/')[1].split(/[?&]/)[0];
                } else if (u.includes('/live/')) {
                  videoId = u.split('/live/')[1].split(/[?&]/)[0];
                } else if (u.includes('watch?v=')) {
                  videoId = u.split('watch?v=')[1].split('&')[0];
                }
                const tMatch = u.match(/[?&]t=(\d+)/);
                if (tMatch) start = `?start=${tMatch[1]}`;
                return `https://www.youtube.com/embed/${videoId}${start}`;
              }
              return '';
            }

            candidates.forEach(infoItem => {
              const infoDiv = document.createElement('div');
              infoDiv.classList.add('news_card');
              infoDiv.style.paddingTop = '30px';

              const maxSpeakersToShow = 2;
              const researchers = Array.isArray(infoItem.researchers) ? infoItem.researchers : [];
              const displayedSpeakers = researchers.slice(0, maxSpeakersToShow);

              const speakersHTML = displayedSpeakers
                .map(r => {
                  const nm = r?.name || '';
                  const link = r?.link?.trim() || '';
                  const isVyri = nm === 'Vyri Yang';
                  const nmHTML = isVyri ? `<strong>${nm}</strong>` : nm;

                  if (!link) {
                    return `<span class="cont-researcher-name-v" style="color:#5d5d5d; cursor:default; text-decoration:none;">${nmHTML}</span>`;
                  } else if (isVyri) {
                    return `<a href="${link}" class="cont-researcher-name-v" style="text-decoration:none;">${nmHTML}</a>`;
                  } else {
                    return `<a href="${link}" target="_blank" rel="noopener noreferrer" class="cont-researcher-name-v" style="text-decoration:none;">${nmHTML}</a>`;
                  }
                })
                .join(', ');

              const remain = Math.max(researchers.length - maxSpeakersToShow, 0);
              const moreSpeakers = remain > 0 ? ` <span class="sec_sub_title_s">and ${remain} more</span>` : '';

              const rawUrl = infoItem.url || infoItem.videoSrc || '';
              const extraUrls = Object.keys(infoItem)
                .filter(k => k.startsWith('url-') && infoItem[k])
                .sort((a,b)=> { // ä¾ url-æ•¸å­—æ’åº
                  const na = parseInt(a.split('-')[1] || '0', 10);
                  const nb = parseInt(b.split('-')[1] || '0', 10);
                  return na - nb;
                })
                .map(k => infoItem[k]);
              const allUrls = [rawUrl, ...extraUrls].filter(Boolean);

              const videoBlocks = allUrls.map(u => {
                const embedUrl = toEmbedUrl(u);
                return embedUrl
                  ? `
                    <div class="video-container" style="margin-top: 20px; position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; max-width: 100%; background: #000;">
                      <iframe src="${embedUrl}" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;" frameborder="0"
                              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                    </div>`
                  : `<div class="sec_sub_title_s"><a href="${u}" target="_blank" rel="noopener noreferrer" style="color:#357132; text-decoration:none;">Watch Video</a></div>`;
              }).join('');

              infoDiv.innerHTML = `
                <div class="sec_sub_title_s">${infoItem.info ?? ''}${infoItem.place ? ' | ' + infoItem.place : ''}</div>
                <div class="sub-title_ss">
                  <a href="${rawUrl || '#'}" style="text-decoration: none; color:#357132;" rel="alternate bookmark" target="_blank">
                    ${infoItem.fullTitel ?? ''}
                  </a>
                </div>
                <div class="sec_sub_title_s overflow">${infoItem.date ?? ''}</div>
                ${speakersHTML ? `<div class="cont-researcher-name_ overflow cursor">Speakers: ${speakersHTML}${moreSpeakers}</div>` : ''}
                ${videoBlocks}
              `;
              infoContent.appendChild(infoDiv);
            });
          }
        }

// ===== Publications =====
return fetch("../json/VyriYang-publications.json", { cache: "no-store" });
})
.then((res) => {
  if (!res) return;
  if (!res.ok) throw new Error("Failed to load ../json/VyriYang-publications.json: " + res.status);
  return res.json();
})
.then((data) => {
  const pubSection = document.getElementById("Publications");
  const accordionContainer = document.getElementById("accordion-2");
  if (!pubSection || !accordionContainer) return;

  const hidePubs = () => {
    if (accordionContainer) accordionContainer.replaceChildren();
    if (pubSection) pubSection.style.display = "none";
  };

  // è‹¥æ²’æœ‰ years æˆ– years ç‚ºç©º â†’ éš±è—é é¢å€å¡Š
  if (!data || !Array.isArray(data.years) || !data.years.length) {
    hidePubs();
    return;
  }

  const asArray = (v) => Array.isArray(v) ? v : (v == null ? [] : [v]);
  const hasTag = (labels, tag) => {
    if (!labels) return false;
    if (Array.isArray(labels)) return labels.includes(tag);
    if (typeof labels === "string") return labels.includes(tag);
    return false;
  };
  const parseTS = (s) => {
    if (!s) return NaN;
    const d = new Date(s);
    if (!isNaN(d)) return d.getTime();
    const m = String(s).match(/^([A-Za-z]+),?\s+(\d{4})$/);
    if (m) {
      const d2 = new Date(`${m[1]} 1, ${m[2]}`);
      return isNaN(d2) ? NaN : d2.getTime();
    }
    return NaN;
  };

  let totalRendered = 0;

  (data?.years || []).forEach((year) => {
    const pubs = (year?.publications || []).filter((pub) => hasTag(pub?.label, "DesignImplications"));
    if (!pubs.length) return;

    const item = document.createElement("div");
    item.className = "accordion-item";

    const heading = document.createElement("div");
    heading.className = "accordion-heading";
    heading.innerHTML = `<h3>${year?.year || ""}</h3><div class="icon"><i class="arrow right"></i></div>`;
    item.appendChild(heading);

    const content = document.createElement("div");
    content.className = "accordion-content";

    pubs.sort((a, b) => {
      const tb = parseTS(b?.date);
      const ta = parseTS(a?.date);
      if (isNaN(tb) && isNaN(ta)) return 0;
      if (isNaN(tb)) return 1;
      if (isNaN(ta)) return -1;
      return tb - ta;
    });

    pubs.forEach((pub) => {
      const pubDiv = document.createElement("div");
      pubDiv.style.paddingBottom = "30px";

      let awardIcon = "";
      const venuesStr = pub?.venues || "";
      if (venuesStr.includes("Best Paper Award")) {
        awardIcon = `<img src="../img/icons/trophy.png" alt="Trophy" style="height:1em;vertical-align:middle;margin-right:5px;">`;
      } else if (venuesStr.includes("Best Paper Honorable Mention Award")) {
        awardIcon = `<img src="../img/icons/medal.png" alt="Medal" style="height:1em;vertical-align:middle;margin-right:5px;">`;
      }

      const venuesHTML = venuesStr
        ? `${awardIcon}<a href="${pub?.url || "#"}" style="text-decoration:none;color:#EBBA4D;" rel="alternate bookmark" target="_blank"><strong>${venuesStr}</strong></a><span style="color:#357132;"> | </span>`
        : "";

      const authorsHTML = asArray(pub?.authors)
        .map((a) => {
          const nm = a?.name || "";
          const link = (a?.link || "").trim();
          const isVyri = nm === "Vyri Yang";
          const nmHTML = isVyri ? `<strong>${nm}</strong>` : nm;

          if (!link) {
            return `<span class="cont-researcher-name-v" style="color:#5d5d5d; cursor:default; text-decoration:none;">${nmHTML}</span>`;
          } else if (isVyri) {
            return `<a href="${link}" class="cont-researcher-name-v" style="text-decoration:none;">${nmHTML}</a>`;
          } else {
            return `<a href="${link}" target="_blank" rel="noopener" class="cont-researcher-name-v" style="text-decoration:none;">${nmHTML}</a>`;
          }
        })
        .join(", ");

      const pdfHTML = pub?.pdf
        ? `<div class="sec_sub_title_a" style="margin-top:5px;margin-bottom:5px;"><a href="${pub.pdf}" style="color:#357132;" rel="alternate bookmark" target="_blank">View Publication</a></div>`
        : "";

      pubDiv.innerHTML = `
        <div class="sub-title_ss">
          ${venuesHTML}
          <a href="${pub?.url || "#"}" style="text-decoration:none;color:#357132;" rel="alternate bookmark" target="_blank">${pub?.title || ""}</a>
        </div>
        <div class="cont-researche overflow" style="margin-top:5px;margin-bottom:5px;">${authorsHTML}</div>
        <div class="sec_sub_title_s" style="margin-top:5px;margin-bottom:5px;">${pub?.venuesname || ""} | ${pub?.date || ""}</div>
        <div class="sec_sub_title_s" style="margin-top:5px;margin-bottom:5px;">${pub?.description || ""}</div>
        ${pdfHTML}
      `;
      content.appendChild(pubDiv);
      totalRendered++;
    });

    if (content.children.length) {
      item.appendChild(content);
      document.getElementById("accordion-2").appendChild(item);
    }
  });

  // å¦‚æœæ²’æœ‰ä»»ä½• publication â†’ éš±è— sectionï¼Œä½†ä¿ç•™ nav link
  if (totalRendered === 0) {
    const acc = document.getElementById("accordion-2");
    if (acc) acc.replaceChildren();
    if (pubSection) pubSection.style.display = "none";
  } else {
    new Accordion(document.getElementById("accordion-2"), {
      multiple: true,
      defaultOpenedIndexes: [0],
    });
  }
})
.catch((err) => {
  console.error("[Projects/Publications] è¼‰å…¥æˆ–è§£æå¤±æ•—ï¼š", err);
  // å¤±æ•—æ™‚ä¹Ÿéš±è— sectionï¼Œä½†ä¿ç•™ nav link
  const pubSection = document.getElementById("Publications");
  const acc = document.getElementById("accordion-2");
  if (acc) acc.replaceChildren();
  if (pubSection) pubSection.style.display = "none";
});


  });
  </script>
</body>
</html>
